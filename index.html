<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#4a0404" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Rozha+One&family=Laila:wght@400;700&display=swap" rel="stylesheet" />
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <script>
    // Tailwind configuration for custom colors and fonts
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            maroon: '#4a0404',
            saffron: '#ff9933',
            cream: '#fdfbf7'
          },
          fontFamily: {
            header: ['"Rozha One"', 'serif'],
            body: ['Laila', '"Noto Sans Devanagari"', 'sans-serif']
          }
        }
      }
    }
  </script>
  <title>Barve Guruji AI</title>
  <style>
    /* Inline fallback styles for offline readability when Tailwind fails to load */
    html { font-family: 'Laila', 'Noto Sans Devanagari', sans-serif; background-color: #fdfbf7; color: #4a0404; }
    .offline-banner { background-color: #ff9933; color: #4a0404; }
  </style>
</head>
<body class="h-full flex flex-col" style="font-family: Laila, \"Noto Sans Devanagari\", sans-serif;">
  <!-- Offline banner -->
  <div id="offlineBanner" class="offline-banner hidden text-center py-1 text-sm">
    ⚠️ You are offline. Some features may be unavailable.
  </div>

  <!-- Header -->
  <header class="bg-maroon text-cream flex items-center justify-between px-4 py-2 shadow-md">
    <h1 class="text-xl font-header">Barve Guruji</h1>
    <div class="flex items-center space-x-3">
      <!-- Language toggle -->
      <button id="langToggle" aria-label="Toggle language" class="text-cream hover:text-saffron focus:outline-none focus:ring-2 focus:ring-saffron px-2 py-1 rounded">
        <span id="langLabel">मराठी</span>
      </button>
      <!-- Settings gear -->
      <button id="settingsBtn" aria-label="Settings" class="text-cream hover:text-saffron focus:outline-none focus:ring-2 focus:ring-saffron p-1 rounded">
        <!-- Gear icon svg -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.983 3.12c.318-.02.637-.03.957-.03.32 0 .639.01.957.03l.4 2.562a7.455 7.455 0 011.767.732l2.24-1.506a9.213 9.213 0 011.346 1.346l-1.506 2.24c.287.547.53 1.128.732 1.767l2.562.4c.02.318.03.637.03.957 0 .32-.01.639-.03.957l-2.562.4a7.455 7.455 0 01-.732 1.767l1.506 2.24a9.213 9.213 0 01-1.346 1.346l-2.24-1.506a7.455 7.455 0 01-1.767.732l-.4 2.562a8.264 8.264 0 01-.957.03c-.32 0-.639-.01-.957-.03l-.4-2.562a7.455 7.455 0 01-1.767-.732l-2.24 1.506a9.213 9.213 0 01-1.346-1.346l1.506-2.24a7.455 7.455 0 01-.732-1.767l-2.562-.4a8.258 8.258 0 01-.03-.957c0-.32.01-.639.03-.957l2.562-.4a7.455 7.455 0 01.732-1.767l-1.506-2.24a9.213 9.213 0 011.346-1.346l2.24 1.506a7.455 7.455 0 011.767-.732l.4-2.562zM12 15.6a3.6 3.6 0 100-7.2 3.6 3.6 0 000 7.2z" />
        </svg>
      </button>
    </div>
  </header>

  <!-- Quick Actions -->
  <div id="quickActions" class="flex overflow-x-auto space-x-2 px-4 py-2 bg-maroon text-cream text-sm">
    <!-- Buttons will be inserted via JS -->
  </div>

  <!-- Chat Area -->
  <main id="chatArea" class="flex-1 overflow-y-auto p-4 space-y-4 bg-cream"></main>

  <!-- Input Area -->
  <form id="inputForm" class="px-4 py-2 bg-cream flex space-x-2 items-end border-t border-maroon" autocomplete="off">
    <textarea id="messageInput" rows="1" placeholder="Type your message..." aria-label="Message input" class="flex-1 resize-none border border-maroon rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-saffron" required></textarea>
    <button id="sendBtn" type="submit" aria-label="Send message" class="bg-saffron text-maroon px-4 py-2 rounded-md font-semibold disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-maroon">
      Send
    </button>
  </form>

  <!-- Typing Indicator -->
  <div id="typingIndicator" class="px-4 py-2 text-center text-sm text-maroon hidden">
    Guruji is typing...
  </div>

  <!-- Settings Panel (hidden by default) -->
  <div id="settingsPanel" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-cream text-maroon w-11/12 max-w-md rounded-lg shadow-lg p-4 overflow-y-auto max-h-screen">
      <h2 class="text-lg font-header mb-4">Settings</h2>
      <!-- Language -->
      <div class="mb-4">
        <label for="settingsLang" class="block mb-1 font-semibold">Language</label>
        <select id="settingsLang" class="w-full border border-maroon rounded p-2 focus:outline-none focus:ring-2 focus:ring-saffron">
          <option value="mr">मराठी</option>
          <option value="en">English</option>
        </select>
      </div>
      <!-- API Key Management -->
      <div class="mb-4">
        <label class="block mb-1 font-semibold" for="apiKeyInput">Gemini API Key</label>
        <input type="password" id="apiKeyInput" placeholder="Enter your API key" class="w-full border border-maroon rounded p-2 focus:outline-none focus:ring-2 focus:ring-saffron" />
        <button id="saveApiKey" class="mt-2 bg-saffron text-maroon px-3 py-1 rounded hover:bg-maroon hover:text-cream transition">Save Key</button>
        <button id="forgetApiKey" class="mt-2 ml-2 bg-maroon text-cream px-3 py-1 rounded hover:bg-saffron hover:text-maroon transition">Forget Key</button>
        <p class="mt-2 text-xs text-maroon">Client-side key is retrievable by advanced users; OK for personal use. For true production, use a proxy.</p>
      </div>
      <!-- Session Management -->
      <div class="mb-4">
        <h3 class="font-semibold mb-2">Consultations</h3>
        <div id="sessionsList" class="space-y-2"></div>
        <button id="newSessionBtn" class="mt-2 bg-saffron text-maroon px-3 py-1 rounded hover:bg-maroon hover:text-cream transition">New Consultation</button>
      </div>
      <!-- Import / Export -->
      <div class="mb-4">
        <h3 class="font-semibold mb-2">Import / Export</h3>
        <div class="flex space-x-2 mb-2">
          <button id="exportCurrentBtn" class="flex-1 bg-saffron text-maroon px-3 py-1 rounded hover:bg-maroon hover:text-cream transition">Export Current</button>
          <button id="exportAllBtn" class="flex-1 bg-saffron text-maroon px-3 py-1 rounded hover:bg-maroon hover:text-cream transition">Export All</button>
        </div>
        <input type="file" id="importFileInput" accept="application/json" class="block w-full text-sm" />
      </div>
      <!-- Close Button -->
      <div class="text-right">
        <button id="closeSettings" class="bg-maroon text-cream px-4 py-1 rounded hover:bg-saffron hover:text-maroon transition">Close</button>
      </div>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
